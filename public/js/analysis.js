$(function(){$(".persession").attr("data-content",'ページ/セッションに課題があります。<br><br><a class="orange-color" href="https://kagari.ai/blog/sessions/" target="_blank">改善方法をみる</a>'),$(".pagetime").attr("data-content",'平均ページ滞在時間に課題があります。<br><br><a class="orange-color" href="https://kagari.ai/blog/page-stay-time/" target="_blank">改善方法をみる</a>'),$(".goodbye").attr("data-content",'直帰率に課題があります。<br><br><a class="orange-color" href="https://kagari.ai/blog/bounce-rate/" target="_blank">改善方法をみる</a>'),$(".click").attr("data-content",'クリック数に課題があります。<br><br><a class="orange-color" href="https://kagari.ai/blog/clicks/" target="_blank">改善方法をみる</a>'),$(".ctr-td").attr("data-content",'CTRに課題があります。<br><br><a class="orange-color" href="https://kagari.ai/blog/ctr/" target="_blank">改善方法をみる</a>'),$(".position").attr("data-content",'掲載順位に課題があります。<br><br><a class="orange-color" href="https://kagari.ai/blog/position/" target="_blank">改善方法をみる</a>'),$(".display-td").attr("data-content",'表示回数に課題があります。<br><br><a class="orange-color" href="https://kagari.ai/blog/impressions/" target="_blank">改善方法をみる</a>'),$(".scopeOn").on("click",function(){$(this).addClass("orange-back"),$(".scopeOff").hasClass("orange-back")&&$(".scopeOff").removeClass("orange-back"),$(".alert-back").addClass("active")}),$(".scopeOff").on("click",function(){$(this).addClass("orange-back"),$(".scopeOn").hasClass("orange-back")&&$(".scopeOn").removeClass("orange-back"),$("td").removeClass("active")})}),$(function(){var t=$("#table").tablesorter();$("button.reportExport, .scopeOn, .comparOn").css({cursor:"wait","background-color":"#eee"}),$("button.reportExport").attr("disabled");var a=$("#json_kagari").val().replace("[","").replace("]","").split(",");let e=$("#json_kagari").attr("kagariUrl"),o=$("#json_kagari").attr("kagari_start"),r=$("#json_kagari").attr("kagari_end"),s=$("#json_kagari").attr("action"),n=0;$.each(a,function(t,a){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$.ajax({url:s,type:"GET",datatype:"json",data:{value:a,url:e,start:o,end:r}}).done(function(a){n=t+1,$("#keyword-"+n).text(a[0]),a[1]<5&&""!=a[4]?$("#click-"+n).addClass("alert-back"):$("#click-"+n).removeAttr("data-toggle"),$("#click-"+n).text(a[1]),$("#display-"+n).text(a[2]),$("#ctr-"+n).text((100*a[3]).toFixed(1)),a[2]<11?$("#display-"+n).addClass("alert-back"):$("#display-"+n).removeAttr("data-toggle"),100*a[3]<10?$("#ctr-"+n).addClass("alert-back"):$("#ctr-"+n).removeAttr("data-toggle"),a[4]>80?$("#position-"+n).addClass("alert-back"):$("#position-"+n).removeAttr("data-toggle"),$("#position-"+n).text(a[4])}).fail(function(t){})}),$(".seoTitle").on("click",function(){$(".seoModal button.reportExport").css({cursor:"wait","background-color":"#eee"}),$(".seoModal td").text(""),$("#0").text("データ取得中…");const t=$(this).attr("site_name");$(".seoModal .modalTxt span").text(t);$(this).attr("url");const a=$(this).attr("content_url"),e=$(this).attr("site_id");$(this).attr("start"),$(this).attr("end");$("#seoTitle").text(t),$("#siteUrlModal a").text(a),$("#siteUrlModal a").attr("href",a),$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$.ajax({type:"GET",datatype:"json",url:"/"+e+"/seo",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:{site_name:$(this).attr("site_name"),url:$(this).attr("url"),content_url:$(this).attr("content_url"),start:$(this).attr("start"),end:$(this).attr("end")}}).done(function(t){if(0==t.length){$("#0").text("データがありませんでした。");for(var a=1;a<95;a++)$("#"+a).text("")}else{var e=t[0],o=t[1],r=t[2],s=t[3],n=t[4],c=t[5],l=t[6],i=t[7],d=t[8],g=t[9];$.each(e,function(t,a){3==t?$("#"+t).text((100*a).toFixed(1)):$("#"+t).text(a)}),$.each(o,function(t,a){3==t?$("#1"+t).text((100*a).toFixed(1)):$("#1"+t).text(a)}),$.each(r,function(t,a){3==t?$("#2"+t).text((100*a).toFixed(1)):$("#2"+t).text(a)}),$.each(s,function(t,a){3==t?$("#3"+t).text((100*a).toFixed(1)):$("#3"+t).text(a)}),$.each(n,function(t,a){3==t?$("#4"+t).text((100*a).toFixed(1)):$("#4"+t).text(a)}),$.each(c,function(t,a){3==t?$("#5"+t).text((100*a).toFixed(1)):$("#5"+t).text(a)}),$.each(l,function(t,a){3==t?$("#6"+t).text((100*a).toFixed(1)):$("#6"+t).text(a)}),$.each(i,function(t,a){3==t?$("#7"+t).text((100*a).toFixed(1)):$("#7"+t).text(a)}),$.each(d,function(t,a){3==t?$("#8"+t).text((100*a).toFixed(1)):$("#8"+t).text(a)}),$.each(g,function(t,a){3==t?$("#9"+t).text((100*a).toFixed(1)):$("#9"+t).text(a)})}}).fail(function(t){})}),$(document).ajaxStop(function(){console.log("ajaxstop"),t.trigger("update",!0),$("button.reportExport").attr("disabled",!1),$("button.reportExport, .scopeOn, .comparOn").attr("style",""),$(".alert-back").popover({html:!0,trigger:"manual"}).on("mouseenter",function(){if($(this).hasClass("active")){var t=this;$(this).popover("show"),$(".popover").on("mouseleave",function(){$(t).popover("hide")})}}).on("mouseleave",function(){var t=this;setTimeout(function(){$(".popover:hover").length||$(t).popover("hide")},100)})})}),$(function(){var t=$(".scrollLeft"),a=2*$(".scrollLeft #table thead tr:nth-child(2) th").eq(3).outerWidth(),e=$(t).outerWidth()-a,o=$(t).outerWidth();$(".seoButton").on("click",function(){t.animate({scrollLeft:0}),$(this).addClass("orange-back"),$(".access-th").removeAttr("style",""),$(".seo-th").css({color:"#FC8C06","background-color":"#fff9f0","border-left":"solid 2px #FC8C06"}),$(".sns-th").removeAttr("style",""),$(".accessBotton").hasClass("orange-back")&&$(".accessBotton").removeClass("orange-back"),$(".snsButton").hasClass("orange-back")&&$(".snsButton").removeClass("orange-back")}),$(".snsButton").on("click",function(){t.animate({scrollLeft:e}),$(this).addClass("orange-back"),$(".access-th").removeAttr("style",""),$(".seo-th").removeAttr("style",""),$(".sns-th").css({color:"#FC8C06","background-color":"#fff9f0","border-left":"solid 2px #FC8C06"}),$(".accessBotton").hasClass("orange-back")&&$(".accessBotton").removeClass("orange-back"),$(".seoButton").hasClass("orange-back")&&$(".seoButton").removeClass("orange-back")}),$(".accessBotton").on("click",function(){t.animate({scrollLeft:o}),$(this).addClass("orange-back"),$(".access-th").css({color:"#FC8C06","background-color":"#fff9f0","border-left":"solid 2px #FC8C06"}),$(".seo-th").removeAttr("style",""),$(".sns-th").removeAttr("style",""),$(".seoButton").hasClass("orange-back")&&$(".seoButton").removeClass("orange-back"),$(".snsButton").hasClass("orange-back")&&$(".snsButton").removeClass("orange-back")})}),$(function(){$(".comparOn").on("click",function(){$(".comparData").hasClass("none")&&$(".comparData").removeClass("none"),$(this).addClass("orange-back"),$(".comparOff").removeClass("orange-back")}),$(".comparOff").on("click",function(){$(this).addClass("orange-back"),$(".comparOn").removeClass("orange-back"),$(".comparData").addClass("none")}),$(".comparOn").on("click",function(){var t=$("#json_kagari").val().replace("[","").replace("]","").split(",");let a=$("#json_kagari").attr("kagariUrl"),e=$("#compar_kagari").attr("startcompar"),o=$("#compar_kagari").attr("endcompar"),r=$("#compar_kagari").attr("action"),s=$("#json_kagari").attr("VIEW_ID");$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$.ajax({url:r,type:"GET",datatype:"json",data:{start:e,end:o,view_id:s}}).done(function(e){$.each(t,function(t,o){o=(o=o.slice(1,-1)).replace(/\\/g,"");$.each(e,function(t,e){function r(t,a){var e=Math.pow(10,a);return Math.round(t*e)/e}var s=a+e[1].replace(/\s+/g,"");if(o==s){var n=(n=(n=s.replace(/\//g,"")).replace(/:/g,"")).replace(/\./g,""),c=$("#"+n+"-3-origin").text(),l=$("#"+n+"-4-origin").text(),i=$("#"+n+"-5-origin").text(),d=$("#"+n+"-6-origin").text(),g=$("#"+n+"-7-origin").text(),p=$("#"+n+"-8-origin").text(),x=$("#"+n+"-9-origin").text(),u=$("#"+n+"-10-origin").text();function r(t,a){var e=Math.pow(10,a);return Math.round(t*e)/e}function f(t,a){var e=100*(e=a/t-1);return e=Math.round(e)}console.log(c),console.log(e[2]),console.log(isNaN(c)),console.log(isNaN(e[2])),$("#"+n+"-3").text(e[2]),e[2]<c&&$("#"+n+"-3-rate").text(f(e[2],c)+"%").css("color","green").addClass("rateUp"),e[2]>c&&$("#"+n+"-3-rate").text(f(e[2],c)+"%").css("color","red").addClass("rateDown"),e[2]==c&&$("#"+n+"-3-rate").text("0%").css("color","green").addClass("rateUp"),$("#"+n+"-4").text(e[3]),e[3]<l?$("#"+n+"-4-rate").text(f(e[3],l)+"%").css("color","green").addClass("rateUp"):e[3]==l?$("#"+n+"-4-rate").text("0%").css("color","green").addClass("rateUp"):$("#"+n+"-4-rate").text(f(e[3],l)+"%").css("color","red").addClass("rateDown"),$("#"+n+"-5").text(r(e[4],2)),r(e[4],2)<i?$("#"+n+"-5-rate").text(f(e[4],i)+"%").css("color","green").addClass("rateUp"):r(e[4],2)==i?$("#"+n+"-5-rate").text("0%").css("color","green").addClass("rateUp"):$("#"+n+"-5-rate").text(f(e[4],i)+"%").css("color","red").addClass("rateDown"),$("#"+n+"-6").text(e[5]),e[5]<d?$("#"+n+"-6-rate").text(f(e[5],d)+"%").css("color","green").addClass("rateUp"):e[5]==d?$("#"+n+"-6-rate").text("0%").css("color","green").addClass("rateUp"):$("#"+n+"-6-rate").text(f(e[5],d)+"%").css("color","red").addClass("rateDown"),$("#"+n+"-7").text(r(e[6],2)),r(e[6],2)<g?$("#"+n+"-7-rate").text(f(e[6],g)+"%").css("color","green").addClass("rateUp"):r(e[6],2)==g?$("#"+n+"-7-rate").text("0%").css("color","green").addClass("rateUp"):$("#"+n+"-7-rate").text(f(e[6],g)+"%").css("color","red").addClass("rateDown"),$("#"+n+"-8").text(r(e[7],2)),r(e[7],2)<p?$("#"+n+"-8-rate").text(f(e[7],p)+"%").css("color","green").addClass("rateUp"):r(e[7],2)==p?$("#"+n+"-8-rate").text("0%").css("color","green").addClass("rateUp"):$("#"+n+"-8-rate").text(f(e[7],p)+"%").css("color","red").addClass("rateDown"),$("#"+n+"-9").text(Math.floor(e[8])),Math.floor(e[8])<x?$("#"+n+"-9-rate").text(f(e[8],x)+"%").css("color","green").addClass("rateUp"):Math.floor(e[8])==x?$("#"+n+"-9-rate").text("0%").css("color","green").addClass("rateUp"):$("#"+n+"-9-rate").text(f(e[8],x)+"%").css("color","red").addClass("rateDown"),$("#"+n+"-10").text(e[9]),e[9]<u?$("#"+n+"-10-rate").text(f(e[9],u)+"%").css("color","green").addClass("rateUp"):e[9]==u?$("#"+n+"-10-rate").text("0%").css("color","green").addClass("rateUp"):$("#"+n+"-10-rate").text(f(e[9],u)+"%").css("color","red").addClass("rateDown")}})})}).fail(function(t){console.log("error-sc-ajax")})}),$(".comparOn").on("click",function(){var t=$("#json_kagari").val().replace("[","").replace("]","").split(",");let a=$("#json_kagari").attr("kagariUrl"),e=$("#compar_kagari").attr("startcompar"),o=$("#compar_kagari").attr("endcompar"),r=$("#json_kagari").attr("action");$.each(t,function(t,s){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$.ajax({url:r,type:"GET",datatype:"json",data:{value:s,url:a,start:e,end:o}}).done(function(t){}).fail(function(t){console.log("error-sc-ajax")})})})});
